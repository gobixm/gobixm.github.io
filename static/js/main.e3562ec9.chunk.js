(this["webpackJsonpsimviz-react-example"]=this["webpackJsonpsimviz-react-example"]||[]).push([[0],{47:function(e,t,n){e.exports={host:"pattern-page_host__3gbVy",visualization:"pattern-page_visualization__8xKPu",timeline:"pattern-page_timeline__--Wrr"}},49:function(e,t,n){e.exports={main:"App_main__f_7Xj",navPane:"App_navPane__3rA0r",page:"App_page__3wESw"}},68:function(e,t,n){e.exports={panel:"time-panel_panel__2v4gz"}},71:function(e,t,n){e.exports={host:"history-panel_host__2XxYl"}},86:function(e,t,n){},87:function(e,t,n){},98:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),s=n(32),o=n.n(s),c=(n(86),n(87),n(143)),a=n(144),u=n(140),d=n(137),h=n(34),l=n(16),f=n(14),b=n(6),p=n(10),y=n(21),k=n(22),v=function(){function e(){Object(y.a)(this,e),this._logicTime=0,this._subscribers=new Set}return Object(k.a)(e,[{key:"logicTime",get:function(){return this._logicTime}},{key:"tick",value:function(e){var t=this;this._logicTime+=e,this._subscribers.forEach((function(e){return e(t._logicTime)}))}},{key:"subscribeTick",value:function(e){var t=this;return this._subscribers.add(e),function(){return t._subscribers.delete(e)}}}]),e}(),j=function(){function e(t,n,i){Object(y.a)(this,e),this._type=t,this._body=n,this._metadata=i}return Object(k.a)(e,[{key:"body",get:function(){return this._body}},{key:"metadata",get:function(){return this._metadata}},{key:"type",get:function(){return this._type}}]),e}();function g(e){return"object"!=typeof e||null===e?e:e instanceof Set?new Set(Array.from(e,g)):e instanceof Map?new Map(Array.from(e,(function(e){var t=Object(p.a)(e,2);return[t[0],g(t[1])]}))):e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e.source,e.flags):Object.keys(e).reduce((function(t,n){return Object.assign(t,Object(b.a)({},n,g(e[n])))}),Array.isArray(e)?[]:{})}function m(e){return function(){return e}}function x(e,t){return function(){return Math.random()*(t-e)+e}}var _={latencyProvider:m(500)},w=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(y.a)(this,e),this._timeline=t,this._history=n,this._packetCounter=0,this._inflightPackets=new Map,this._pendingPackets=[],this._nodes=new Map,this._tickUnsubscribe=void 0,this._nodesSubscriptions=new Set,this._packetsSubscriptions=new Set,this._options=Object.assign(Object.assign({},_),i)}return Object(k.a)(e,[{key:"nodes",get:function(){return Array.from(this._nodes.values())}},{key:"start",value:function(){var e=this;this._tickUnsubscribe||(this._tickUnsubscribe=this._timeline.subscribeTick((function(t){return e.onTick(t)})))}},{key:"stop",value:function(){this._tickUnsubscribe&&(this._tickUnsubscribe(),this._tickUnsubscribe=void 0)}},{key:"registerNode",value:function(e){this._nodes.set(e.id,e),this.notifyNode("reg",e)}},{key:"unregisterNode",value:function(e){var t=this._nodes.get(e);t&&(this._nodes.delete(e),this.notifyNode("unreg",t))}},{key:"sendPacket",value:function(e,t,n,i,r,s){var o={id:this._packetCounter++,latency:void 0===r?this.getLatency():r,receiver:i,sender:n,sentAt:this._timeline.logicTime+(null!=s?s:0)},c=new j(e,t,o);return s?(this._pendingPackets=[].concat(Object(f.a)(this._pendingPackets),[{packet:c,senderState:g(n.state)}]).sort((function(e,t){return e.packet.metadata.sentAt-t.packet.metadata.sentAt})),c):(this.addInflight(c),this._history.add({type:"send",packet:c,nodeState:g(n.state)}),this.notifyPacket("sent",c),c)}},{key:"sendBroadcastPacket",value:function(e,t,n,i,r){var s=this;return Array.from(this._nodes.values()).filter((function(e){return e.id!==n.id})).map((function(o){return s.sendPacket(e,t,n,o,i,r)}))}},{key:"subscribeNodes",value:function(e){var t=this;return this._nodesSubscriptions.add(e),function(){return t._nodesSubscriptions.delete(e)}}},{key:"subscribePackets",value:function(e){var t=this;return this._packetsSubscriptions.add(e),function(){return t._packetsSubscriptions.delete(e)}}},{key:"getLatency",value:function(){return this._options.latencyProvider(this)}},{key:"addInflight",value:function(e){this._inflightPackets.set(e.metadata.id,e)}},{key:"removeInflight",value:function(e){this._inflightPackets.delete(e)}},{key:"onTick",value:function(e){var t=this;this._pendingPackets.forEach((function(n){n.packet.metadata.sentAt<=e&&(t.addInflight(n.packet),t._history.add({type:"send",packet:n.packet,nodeState:n.senderState}),t.notifyPacket("sent",n.packet))})),this._pendingPackets=this._pendingPackets.filter((function(t){return t.packet.metadata.sentAt>e})),this._inflightPackets.forEach((function(n,i){n.metadata.sentAt+n.metadata.latency<=e&&(t.onPacketReceived(n),t.removeInflight(i),t.notifyPacket("received",n))}))}},{key:"onPacketReceived",value:function(e){var t=this._nodes.get(e.metadata.receiver.id);t&&(t.processPacket(e),this._history.add({type:"receive",packet:e,nodeState:g(t.state)}))}},{key:"notifyPacket",value:function(e,t){this._packetsSubscriptions.forEach((function(n){return n({type:e,packet:t})}))}},{key:"notifyNode",value:function(e,t){this._nodesSubscriptions.forEach((function(n){return n({type:e,node:t})}))}}]),e}(),O=function(){function e(t,n,i){Object(y.a)(this,e),this._id=t,this._network=n,this._state=i,this._handlers=new Map}return Object(k.a)(e,[{key:"id",get:function(){return this._id}},{key:"state",get:function(){return this._state}},{key:"send",value:function(e,t,n,i,r){return this._network.sendPacket(e,t,this,n,i,r)}},{key:"processPacket",value:function(e){var t=this._handlers.get(e.type);t&&t(e,this._state)}},{key:"registerHandler",value:function(e,t){var n=this;this._handlers.set(e,(function(e,i){return n._state=t(e,i)}))}},{key:"unregisterHandler",value:function(e){this._handlers.delete(e)}}]),e}(),P=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;Object(y.a)(this,e),this._retention=t,this._history=[]}return Object(k.a)(e,[{key:"history",get:function(){return this._history}},{key:"add",value:function(e){this._history=[].concat(Object(f.a)(this._history),[e]),this.retain()}},{key:"clear",value:function(){this.retain(0)}},{key:"retain",value:function(e){var t=void 0===e?this._retention:e,n=this._history.length-t;n<=0||this._history.splice(0,n)}}]),e}();function S(e,t,n){return Math.abs(e-t)<=n}function N(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.001;return S(e,t,n)?0:e-t}function V(e,t,n,i){var r=Math.hypot(n.x-e.x,n.y-e.y),s=Math.hypot(i.x-e.x,i.y-e.y);if(!(r>t&&s>t)&&!(r<t&&s<t)){var o=function(e,t,n,i){var r=e.x*e.x+e.y*e.y-t*t,s=-2*e.x,o=-2*e.y,c=n.x*i.y-i.x*n.y,a=n.y-i.y,u=n.x-i.x;S(u,0,.001)&&(u=.001);var d=u*u+a*a,h=u*u*s+2*c*a+u*o*a,l=h*h-4*d*(r*u*u+c*c+u*o*c);if(l<0)return[];if(l<.001){var f=-h/(2*d);return[{x:f,y:(a*f+c)/u}]}var b=(-h+Math.sqrt(l))/(2*d),p=(a*b+c)/u,y=(-h-Math.sqrt(l))/(2*d);return[{x:b,y:p},{x:y,y:(a*y+c)/u}]}(e,t,n,i);if(!(o.length<1)){var c=Math.min(n.x,i.x),a=Math.max(n.x,i.x),u=Math.min(n.y,i.y),d=Math.max(n.y,i.y);return N(o[0].x,c)>=0&&N(o[0].x,a)<=0&&N(o[0].y,u)>=0&&N(o[0].y,d)<=0?o[0]:N(o[1].x,c)>=0&&N(o[1].x,a)<=0&&N(o[1].y,u)>=0&&N(o[1].y,d)<=0?o[1]:void 0}}}var E={radius:10,color:"#0000ee",showStateOnCreate:!0},A=function(){function e(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Object(y.a)(this,e),this._packet=t,this._sender=n,this._receiver=i,this._options=Object.assign(Object.assign({},E),r),this._origin=n.origin,this._from=n.origin,this._to=i.origin,this.update(t.metadata.sentAt)}return Object(k.a)(e,[{key:"from",get:function(){return this._from}},{key:"to",get:function(){return this._to}},{key:"origin",get:function(){return this._origin}},{key:"id",get:function(){return this._packet.metadata.id}},{key:"body",get:function(){return this._packet.body}},{key:"metadata",get:function(){return this._packet.metadata}},{key:"type",get:function(){return this._packet.type}},{key:"options",get:function(){return this._options}},{key:"update",value:function(e){var t=V(this._sender.origin,this._sender.options.radius,this._sender.origin,this._receiver.origin)||this._sender.origin,n=V(this._receiver.origin,this._receiver.options.radius,this._receiver.origin,this._sender.origin)||this._receiver.origin;this._from=t,this._to=n;var i=e-this._packet.metadata.sentAt,r=this._packet.metadata.sentAt+this._packet.metadata.latency-e;if(0!==r){var s=i/r,o=(t.x+n.x*s)/(1+s),c=(t.y+n.y*s)/(1+s);this._origin={x:o,y:c}}else this._origin=n}}]),e}(),M={radius:40,color:"#eeeeee"},T=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(y.a)(this,e),this._node=t,this._origin={x:0,y:0},this._options=Object.assign(Object.assign({},M),n)}return Object(k.a)(e,[{key:"x",get:function(){return this._origin.x}},{key:"y",get:function(){return this._origin.y}},{key:"origin",get:function(){return this._origin}},{key:"id",get:function(){return this._node.id}},{key:"options",get:function(){return this._options}},{key:"state",get:function(){return this._node.state}},{key:"move",value:function(e){this._origin=e}}]),e}(),C=function(e){return"hsl(".concat(137.508*e,",50%,75%)")},R={nodeArrageRadius:400,nodeColorGenerator:C,packetOptionsFactory:function(){return{}}},I=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(y.a)(this,e),this._netowork=t,this._nodes=[],this._packets=[],this._nodeCounter=0,this._nodesSubscriptions=new Set,this._packetsSubscriptions=new Set,t.nodes.forEach((function(e){return n.addNode(e)})),this._nodeSubscription=t.subscribeNodes((function(e){return n.onNode(e)})),this._packetSubscription=t.subscribePackets((function(e){return n.onPacket(e)})),this._options=Object.assign(Object.assign({},R),i)}return Object(k.a)(e,[{key:"nodes",get:function(){return this._nodes}},{key:"packets",get:function(){return this._packets}},{key:"options",get:function(){return this._options}},{key:"destroy",value:function(){this._nodeSubscription(),this._packetSubscription()}},{key:"subscribeNodes",value:function(e){var t=this;return this._nodesSubscriptions.add(e),function(){return t._nodesSubscriptions.delete(e)}}},{key:"subscribePackets",value:function(e){var t=this;return this._packetsSubscriptions.add(e),function(){return t._packetsSubscriptions.delete(e)}}},{key:"onNode",value:function(e){switch(e.type){case"reg":this.addNode(e.node);break;case"unreg":this.removeNode(e.node)}}},{key:"createNodeView",value:function(e){return new T(e,{color:this._options.nodeColorGenerator(this._nodeCounter,e,this._netowork)})}},{key:"addNode",value:function(e){var t;this._nodes=[].concat(Object(f.a)(this._nodes),[this.createNodeView(e)]),this.arrangeNodes(this._options.nodeArrageRadius),this._nodeCounter++,null===(t=this._nodesSubscriptions)||void 0===t||t.forEach((function(e){return e()}))}},{key:"removeNode",value:function(e){var t;this._nodes=this._nodes.filter((function(t){return t.id!==e.id})),this.arrangeNodes(this._options.nodeArrageRadius),null===(t=this._nodesSubscriptions)||void 0===t||t.forEach((function(e){return e()}))}},{key:"arrangeNodes",value:function(e){var t=this;this._nodes.forEach((function(n,i){var r=Math.cos(Math.PI-2*i*Math.PI/t._nodes.length)*e,s=-Math.sin(Math.PI-2*i*Math.PI/t._nodes.length)*e;n.move({x:r,y:s})}))}},{key:"findNodeView",value:function(e){return this._nodes.find((function(t){return t.id===e}))}},{key:"onPacket",value:function(e){switch(e.type){case"sent":this.addPacket(e.packet);break;case"received":this.removePacket(e.packet)}}},{key:"createPacketView",value:function(e){var t=this.findNodeView(e.metadata.sender.id),n=this.findNodeView(e.metadata.receiver.id);if(t&&n)return new A(e,t,n,this._options.packetOptionsFactory(e.metadata.id,e,this._netowork))}},{key:"addPacket",value:function(e){var t,n=this.createPacketView(e);n&&(this._packets=[].concat(Object(f.a)(this._packets),[n]),null===(t=this._packetsSubscriptions)||void 0===t||t.forEach((function(e){return e()})))}},{key:"removePacket",value:function(e){var t;this._packets=this._packets.filter((function(t){return t.id!==e.metadata.id})),null===(t=this._packetsSubscriptions)||void 0===t||t.forEach((function(e){return e()}))}}]),e}(),H=function(){function e(t){Object(y.a)(this,e),this._packet=t,this._from={x:0,y:0},this._to={x:0,y:0},this._typeOrigin={x:0,y:0}}return Object(k.a)(e,[{key:"packetMetadata",get:function(){return this._packet.metadata}},{key:"from",get:function(){return this._from}},{key:"to",get:function(){return this._to}},{key:"type",get:function(){return this._packet.type}},{key:"typeOrigin",get:function(){return this._typeOrigin}},{key:"move",value:function(e,t){this._from=e,this._to=t,this._typeOrigin={x:(this._from.x+this._to.x)/2,y:(this._from.y+this._to.y)/2}}}]),e}(),B=function(){function e(t){Object(y.a)(this,e),this._node=t,this._x=0,this._height=0}return Object(k.a)(e,[{key:"id",get:function(){return this._node.id}},{key:"x",get:function(){return this._x},set:function(e){this._x=e}},{key:"height",get:function(){return this._height},set:function(e){this._height=e}}]),e}(),q={nodeSpacing:200,timescale:.1},z=function(){function e(t,n){var i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(y.a)(this,e),this._network=t,this._history=n,this._nodeTimelinesMap=new Map,this._nodeTimelines=[],this._networkEvents=[],this._options=Object.assign(Object.assign({},q),r),t.nodes.forEach((function(e){return i.addNodeTimeline(e)})),this._networkEvents=this.buildNetworkEvents(),this._nodesSubscription=this.subscribeNodes(),this._packetsSubscription=this.subscribePackets()}return Object(k.a)(e,[{key:"events",get:function(){return this._networkEvents}},{key:"nodeTimelines",get:function(){return this._nodeTimelines}},{key:"destroy",value:function(){this._packetsSubscription(),this._nodesSubscription()}},{key:"subscribeNodes",value:function(){var e=this;return this._network.subscribeNodes((function(t){"reg"===t.type&&e.addNodeTimeline(t.node)}))}},{key:"addNodeTimeline",value:function(e){var t=new B(e);this._nodeTimelines.push(t),this._nodeTimelinesMap.set(e.id,t),this.arrangeNodes()}},{key:"subscribePackets",value:function(){var e=this;return this._network.subscribePackets((function(t){"received"===t.type&&(e._networkEvents=e.buildNetworkEvents())}))}},{key:"buildNetworkEvents",value:function(){var e=this._history.history.filter((function(e){return"receive"===e.type})).map((function(e){return new H(e.packet)}));return this.arrangeHistory(e),e}},{key:"arrangeNodes",value:function(){var e=this;this._nodeTimelines.forEach((function(t,n){t.x=n*e._options.nodeSpacing}))}},{key:"arrangeHistory",value:function(e){var t=this,n=1/0,i=0;e.forEach((function(e){n=Math.min(n,e.packetMetadata.sentAt),i=Math.max(i,e.packetMetadata.sentAt+e.packetMetadata.latency)})),e.forEach((function(e){var i,r,s,o,c={x:null!==(r=null===(i=t._nodeTimelinesMap.get(e.packetMetadata.sender.id))||void 0===i?void 0:i.x)&&void 0!==r?r:0,y:t._options.timescale*(e.packetMetadata.sentAt-n)},a={x:null!==(o=null===(s=t._nodeTimelinesMap.get(e.packetMetadata.receiver.id))||void 0===s?void 0:s.x)&&void 0!==o?o:0,y:t._options.timescale*(e.packetMetadata.sentAt+e.packetMetadata.latency-n)};e.move(c,a)})),this._nodeTimelines.forEach((function(e){e.height=t._options.timescale*(i-n)}))}}]),e}();function L(e,t){var n=new O(e,t,{counter:0});return n.registerHandler("ping",(function(e,i){i.counter=e.body.counter+1;var r=t.nodes.filter((function(e){return e.id!==n.id})),s=r[Math.floor(Math.random()*r.length)];return n.send("pong",{},e.metadata.sender,void 0,250),n.send("ping",{counter:i.counter},s,void 0,500),i})),t.registerNode(n),n}var G=n(2),U=function(e){var t=e.nodeView,n=e.onClick;return Object(G.jsxs)("g",Object.assign({transform:"translate(".concat(t.x,", ").concat(t.y,")"),onClick:n},{children:[Object(G.jsx)("circle",{fill:t.options.color,r:t.options.radius},void 0),Object(G.jsx)("text",Object.assign({dominantBaseline:"central",textAnchor:"middle"},{children:t.id}),void 0)]}),void 0)};function D(e,t){return t instanceof Map?Object.fromEntries(t.entries()):t instanceof Set?Array.from(t.values()):t}var W=function(e){var t=e.packetView;return Object(G.jsx)("foreignObject",Object.assign({style:{width:"100%",height:"100%",pointerEvents:"none"}},{children:Object(G.jsxs)("div",Object.assign({style:{display:"inline-block",padding:"8px",backgroundColor:"rgba(255,255,255,0.7)",borderRadius:"4px",border:"solid 1px black"}},{children:[Object(G.jsx)("p",Object.assign({style:{fontSize:"13px",fontWeight:600}},{children:t.type}),void 0),Object(G.jsx)("pre",Object.assign({style:{fontSize:"13px"}},{children:JSON.stringify(t.body,D,2)}),void 0)]}),void 0)}),void 0)},Y=function(e){var t=e.packetView,n=e.timescale,r=e.time,s=Object(i.useState)(!1),o=Object(p.a)(s,2),c=o[0],a=o[1],u=Object(i.useRef)(null);return Object(i.useEffect)((function(){u.current.style.setProperty("transform","matrix(1, 0, 0, 1, ".concat(t.from.x,", ").concat(t.from.y,")")),t.options.showStateOnCreate&&a(!0)}),[]),Object(i.useEffect)((function(){var e=u.current;e.style.setProperty("transform",window.getComputedStyle(u.current).getPropertyValue("transform")),window.requestAnimationFrame((function(){e.style.setProperty("transition",function(e,t,n){return"transform ".concat((n.metadata.latency-t+n.metadata.sentAt)*e,"ms linear")}(n,r,t)),e.style.setProperty("transform","matrix(1, 0, 0, 1, ".concat(t.to.x,", ").concat(t.to.y,")"))}))}),[n]),Object(G.jsxs)("g",{children:[Object(G.jsx)("marker",Object.assign({id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"10",refY:"3.5",orient:"auto"},{children:Object(G.jsx)("polygon",{points:"0 0, 10 3.5, 0 7",fill:"red"},void 0)}),void 0),Object(G.jsx)("line",{markerEnd:"url(#arrowhead)",x1:t.from.x,y1:t.from.y,x2:t.to.x,y2:t.to.y,stroke:"black"},void 0),Object(G.jsxs)("g",Object.assign({ref:u,onClick:function(){a((function(e){return!e}))}},{children:[Object(G.jsx)("circle",{fill:t.options.color,r:t.options.radius},void 0),c&&Object(G.jsx)(W,{packetView:t},void 0)]}),void 0),Object(G.jsx)("text",{fill:"blue",dominantBaseline:"central",textAnchor:"middle",x:t.origin.x,y:t.origin.y},void 0)]},void 0)},F=function(e){var t=e.nodeView;return Object(G.jsx)("foreignObject",Object.assign({style:{width:"100%",height:"100%",pointerEvents:"none"}},{children:Object(G.jsx)("div",Object.assign({style:{display:"inline-block",padding:"8px",backgroundColor:"rgba(255,255,255,0.7)",borderRadius:"4px",border:"solid 1px black"}},{children:Object(G.jsx)("pre",Object.assign({style:{fontSize:"13px"}},{children:JSON.stringify(t.state,D,2)}),void 0)}),void 0)}),void 0)},J=function(e){var t=e.networkView,n=e.height,r=e.width,s=e.timescale,o=e.time,c=Object(i.useState)(t.nodes),a=Object(p.a)(c,2),u=a[0],d=a[1],h=Object(i.useState)(t.packets),l=Object(p.a)(h,2),b=l[0],y=l[1],k=Object(i.useState)([]),v=Object(p.a)(k,2),j=v[0],g=v[1];return Object(i.useEffect)((function(){var e=t.subscribeNodes((function(){return d(Object(f.a)(t.nodes))})),n=t.subscribePackets((function(){y(Object(f.a)(t.packets))}));return function(){e(),n()}}),[]),Object(G.jsxs)("svg",Object.assign({height:n,width:r,viewBox:"".concat(-n/2," ").concat(-r/2," ").concat(n," ").concat(r),style:{overflow:"visible"}},{children:[u.map((function(e){return Object(G.jsx)(U,{nodeView:e,onClick:function(){return function(e){j.find((function(t){return t.id===e.id}))?g(Object(f.a)(j.filter((function(t){return t.id!==e.id})))):g([].concat(Object(f.a)(j),[e]))}(e)}},e.id)})),j.map((function(e){return Object(G.jsx)("g",Object.assign({transform:"translate(".concat(e.x-e.options.radius,", ").concat(e.y+20,")")},{children:Object(G.jsx)(F,{nodeView:e},void 0)}),void 0)})),b.map((function(e){return Object(G.jsx)(Y,{packetView:e,timescale:s,time:o},e.id)}))]}),void 0)},X=function(e){var t=e.history,n=e.network,r=Object(i.useState)([]),s=Object(p.a)(r,2),o=s[0],c=s[1],a=Object(i.useState)([]),u=Object(p.a)(a,2),d=u[0],h=u[1],l=Object(i.useState)({width:400,height:400,x:0,y:0}),b=Object(p.a)(l,2),y=b[0],k=b[1],v=Object(i.useRef)(null);return Object(i.useEffect)((function(){var e=n.subscribePackets((function(){if(c(Object(f.a)(t.nodeTimelines)),h(Object(f.a)(t.events)),v.current){var e=(null==v?void 0:v.current).getBBox();k({width:e.width,height:e.height,x:e.x,y:e.y})}}));return function(){e()}}),[]),Object(G.jsxs)("svg",Object.assign({ref:v,width:y.width,height:y.height,viewBox:"".concat(y.x," ").concat(y.y," ").concat(y.width," ").concat(y.height)},{children:[o.map((function(e){return Object(G.jsxs)("g",{children:[Object(G.jsx)("line",{stroke:"black",x1:e.x,y1:0,x2:e.x,y2:e.height},void 0),Object(G.jsx)("text",Object.assign({textAnchor:"middle",x:e.x,y:e.height+20},{children:e.id}),void 0)]},e.id)})),d.map((function(e){return Object(G.jsxs)("g",{children:[Object(G.jsx)("marker",Object.assign({id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"10",refY:"3.5",orient:"auto"},{children:Object(G.jsx)("polygon",{points:"0 0, 10 3.5, 0 7",fill:"red"},void 0)}),void 0),Object(G.jsx)("line",{markerEnd:"url(#arrowhead)",stroke:"black",x1:e.from.x,y1:e.from.y,x2:e.to.x,y2:e.to.y},void 0),Object(G.jsx)("text",Object.assign({textAnchor:"middle",x:e.typeOrigin.x,y:e.typeOrigin.y},{children:e.type}),void 0)]},e.packetMetadata.id)}))]}),void 0)},K=n(47),Q=n.n(K),Z=n(138),$=n(68),ee=n.n($),te=function(e){var t,n=e.timeline,r=e.onTimescale,s=e.onTime,o=Object(i.useState)(1),c=Object(p.a)(o,2),a=c[0],d=c[1];Object(i.useEffect)((function(){return t=setInterval((function(){n.tick(100/a),s&&s(n.logicTime)}),100),function(){clearInterval(t)}}));return Object(G.jsxs)("div",{className:ee.a.panel,children:[Object(G.jsx)(u.a,{variant:"subtitle1",children:"You can steed up or speed down time by moving slider."}),Object(G.jsx)(Z.a,{min:.01,max:10,step:.01,defaultValue:1,onChange:function(e,t){d(t),r&&r(t)}})]})},ne=n(71),ie=n.n(ne),re=function(e){var t=e.network,n=e.historyView;return Object(G.jsx)("div",{className:ie.a.host,children:Object(G.jsx)(X,{history:n,network:t})})},se=function(e){var t=Object(i.useState)(1),n=Object(p.a)(t,2),r=n[0],s=n[1],o=Object(i.useState)(e.timeline.logicTime),c=Object(p.a)(o,2),a=c[0],d=c[1];return Object(i.useEffect)((function(){return e.network.start(),function(){e.network.stop()}}),[]),Object(G.jsxs)("div",{className:Q.a.host,children:[Object(G.jsx)(u.a,{variant:"h4",children:e.title}),Object(G.jsx)(u.a,{variant:"subtitle1",sx:{margin:"10px 0"},children:e.brief}),e.children,Object(G.jsx)("div",{className:Q.a.timeline,children:Object(G.jsx)(te,{timeline:e.timeline,onTime:function(e){return d(e)},onTimescale:function(e){return s(e)}})}),Object(G.jsxs)("div",{className:Q.a.visualization,children:[Object(G.jsx)(J,{networkView:e.networkView,height:600,width:600,timescale:r,time:a}),Object(G.jsx)(re,{historyView:e.historyView,network:e.network})]})]})},oe=function(e){var t=new v,n=new P,i=new w(t,n,{latencyProvider:m(1e3)}),r=new I(i,e),s=new z(i,n),o=L("alice",i),c=L("bob",i);return L("eve",i),o.send("ping",{counter:0},c),{timeline:t,history:n,network:i,networkView:r,historyView:s}}({nodeArrageRadius:200,nodeColorGenerator:C,packetOptionsFactory:function(e,t){return{color:"ping"===t.type?"#ff0000":"880000",radius:"ping"===t.type?10:5}}}),ce=function(){var e=Object(i.useRef)(oe);return Object(i.useEffect)((function(){return oe.network.start(),function(){oe.network.stop()}})),Object(G.jsx)(se,{title:"Ping - Pong example",brief:"Node sends ping to random node. Then receiver sends response, following by ping to another random node.",historyView:e.current.historyView,network:e.current.network,networkView:e.current.networkView,timeline:e.current.timeline})},ae=n(49),ue=n.n(ae);var de=function(e){var t=new v,n=new P,i=new w(t,n,{latencyProvider:m(1e3)}),r=new I(i,e),s=new z(i,n),o=new O("client",i,void 0),c=new O("server",i,void 0);return c.registerHandler("req",(function(e,t){var n=e.body.word.split("").reverse().join("");return c.send("resp",{reverse:n},e.metadata.sender,500),t})),i.registerNode(o),i.registerNode(c),{timeline:t,history:n,network:i,networkView:r,historyView:s,sendWord:function(e){return o.send("req",{word:e},c,500)}}}({nodeArrageRadius:200}),he=n(141),le=n(136),fe=function(){var e=Object(i.useRef)(de),t=Object(i.useRef)(null);return Object(i.useEffect)((function(){return e.current.network.start(),function(){e.current.network.stop()}}),[]),Object(G.jsx)(se,{title:"Request - Reply",brief:"Client sends word in request, server reverse it and sends in reply.",historyView:e.current.historyView,network:e.current.network,networkView:e.current.networkView,timeline:e.current.timeline,children:Object(G.jsxs)(he.a,{sx:{display:"flex"},alignItems:"center",children:[Object(G.jsx)(le.a,{inputRef:t,defaultValue:"foo bar"}),Object(G.jsx)(d.a,{sx:{marginLeft:"10px"},onClick:function(){var n,i;return e.current.sendWord(null!==(n=null===(i=t.current)||void 0===i?void 0:i.value)&&void 0!==n?n:"")},children:"Send Word"})]})})},be=n(50);var pe=function(e){var t=new v,n=new P,i=new w(t,n,{latencyProvider:x(200,2e3)}),r=new I(i,e),s=new z(i,n),o=new O("alice",i,void 0),c=new O("bob",i,void 0),a=new O("eve",i,void 0),u=new O("server",i,{term:0,times:{}});return[o,c,a].forEach((function(e){e.registerHandler("survey",(function(n){var r=t.logicTime;i.sendPacket("resp",{term:n.body.term,time:r},e,n.metadata.sender)}))})),u.registerHandler("resp",(function(e,t){if(e.body.term===t.term){var n=Object(be.a)({},t.times);return n[e.metadata.sender.id]=e.body.time,Object(be.a)(Object(be.a)({},t),{},{times:n})}return t})),i.registerNode(u),i.registerNode(o),i.registerNode(c),i.registerNode(a),{timeline:t,history:n,network:i,networkView:r,historyView:s,sendSurvey:function(){u.state.term+=1,i.sendBroadcastPacket("survey",{term:u.state.term},u)}}}({nodeArrageRadius:200}),ye=function(){var e=Object(i.useRef)(pe);return Object(i.useEffect)((function(){return e.current.network.start(),function(){e.current.network.stop()}}),[]),Object(G.jsx)(se,{title:"Survey",brief:"Server broadcasts request to all client asking time. Clients responses with time.",historyView:e.current.historyView,network:e.current.network,networkView:e.current.networkView,timeline:e.current.timeline,children:Object(G.jsx)(he.a,{sx:{display:"flex"},alignItems:"center",children:Object(G.jsx)(d.a,{sx:{marginLeft:"10px"},onClick:function(){return e.current.sendSurvey()},children:"Send Survey"})})})};var ke=function(e){var t=new v,n=new P,i=new w(t,n,{latencyProvider:x(300,600)}),r=new I(i,e),s=new z(i,n),o=new O("broker",i,{subs:{}}),c=new O("alice",i,void 0),a=new O("bob",i,void 0),u=new O("eve",i,void 0);return o.registerHandler("sub",(function(e,t){var n=e.body.topic,i=e.metadata.sender.id;return t.subs[n]||(t.subs[n]=new Set),t.subs[n].add(i),t})),o.registerHandler("unsub",(function(e,t){var n=e.body.topic,i=e.metadata.sender.id;return t.subs[n]&&t.subs[n].delete(i),t})),o.registerHandler("pub",(function(e,t){var n,r=e.body.topic;return Array.from(null!==(n=t.subs[r])&&void 0!==n?n:[]).forEach((function(t){var n=i.nodes.find((function(e){return e.id===t}));n&&i.sendPacket("msg",{topic:r,body:e.body.message},o,n)})),t})),i.registerNode(o),i.registerNode(c),i.registerNode(a),i.registerNode(u),{timeline:t,history:n,network:i,networkView:r,historyView:s,publish:function(e){i.sendPacket("pub",{topic:e,message:"the data"},u,o)},subscribe:function(e,t){var n=i.nodes.find((function(t){return t.id===e}));n&&i.sendPacket("sub",{topic:t},n,o)},unsubscribe:function(e,t){var n=i.nodes.find((function(t){return t.id===e}));n&&i.sendPacket("unsub",{topic:t},n,o)}}}({nodeArrageRadius:200}),ve=function(){var e=Object(i.useRef)(ke),t=function(t){return e.current.subscribe(t,"topic")},n=function(t){return e.current.unsubscribe(t,"topic")};return Object(i.useEffect)((function(){return e.current.network.start(),function(){e.current.network.stop()}}),[]),Object(G.jsxs)(se,{title:"Publish - Subscribe",brief:"Client subscribes to broker on certain topic. Then client makes publishes message to this topic. All subscribed clients receive this message.",historyView:e.current.historyView,network:e.current.network,networkView:e.current.networkView,timeline:e.current.timeline,children:[Object(G.jsx)(he.a,{sx:{display:"flex"},alignItems:"center",children:Object(G.jsx)(d.a,{sx:{marginLeft:"10px"},onClick:function(){return e.current.publish("topic")},children:"Publish"})}),Object(G.jsxs)(he.a,{sx:{display:"flex"},alignItems:"center",children:[Object(G.jsx)(d.a,{sx:{marginLeft:"10px"},onClick:function(){return t("alice")},children:"Subscribe Alice"}),Object(G.jsx)(d.a,{sx:{marginLeft:"10px"},onClick:function(){return n("alice")},children:"Unsubscribe Alice"})]}),Object(G.jsxs)(he.a,{sx:{display:"flex"},alignItems:"center",children:[Object(G.jsx)(d.a,{sx:{marginLeft:"10px"},onClick:function(){return t("bob")},children:"Subscribe Bob"}),Object(G.jsx)(d.a,{sx:{marginLeft:"10px"},onClick:function(){return n("bob")},children:"Unsubscribe Bob"})]})]})};var je=function(e){var t=new v,n=new P,i=new w(t,n,{latencyProvider:x(300,600)}),r=new I(i,e),s=new z(i,n),o=new O("general",i,{}),c=new O("alice",i,{commands:new Map,decision:void 0}),a=new O("bob",i,{commands:new Map,decision:void 0}),u=new O("traitor",i,{commands:new Map,decision:void 0});return[c,a].forEach((function(e){e.registerHandler("command",(function(t,n){var r=t.body.action,s=t.metadata.sender;if(s.id===o.id?(n.commands.set(e.id,r),i.nodes.filter((function(t){return t.id!==e.id&&t.id!==o.id})).forEach((function(t){return i.sendPacket("command",{action:r},e,t)}))):n.commands.set(s.id,r),n.commands.size===i.nodes.length-1){var c=Array.from(n.commands.values());n.decision=c.filter((function(e){return"attack"===e})).length>=(i.nodes.length-1)/2?"attack":"retreat"}return n}))})),u.registerHandler("command",(function(e,t){var n="attack"===e.body.action?"retreat":"attack",r=e.metadata.sender;return r.id===o.id?(t.commands.set(u.id,n),i.nodes.filter((function(e){return e.id!==u.id&&e.id!==o.id})).forEach((function(e){return i.sendPacket("command",{action:n},u,e)}))):t.commands.set(r.id,n),t.decision=n,t})),i.registerNode(o),i.registerNode(c),i.registerNode(a),i.registerNode(u),{timeline:t,history:n,network:i,networkView:r,historyView:s,sendCommand:function(e){o.state.command=e,i.nodes.filter((function(e){return e.id!==o.id})).forEach((function(t){return i.sendPacket("command",{action:e},o,t)}))}}}({nodeArrageRadius:150}),ge=function(){var e=Object(i.useRef)(je),t=function(t){return e.current.sendCommand(t)};return Object(i.useEffect)((function(){return e.current.network.start(),function(){e.current.network.stop()}}),[]),Object(G.jsx)(se,{title:"Byzantine Generals Problem",brief:"General sends command to lieutenants. They will win either if majority will attack, or survive if majority is retreat. But there is traitor who tries to mess the decision. The solution is to each lieutenant sends to others what he heared from general. After all messages received lieutenant looks for majority. Such a solution requires 3m+1 nodes to tolerate m traitors.",historyView:e.current.historyView,network:e.current.network,networkView:e.current.networkView,timeline:e.current.timeline,children:Object(G.jsxs)(he.a,{sx:{display:"flex"},alignItems:"center",children:[Object(G.jsx)(d.a,{sx:{marginLeft:"10px"},onClick:function(){return t("attack")},children:"Attack!"}),Object(G.jsx)(d.a,{sx:{marginLeft:"10px"},onClick:function(){return t("retreat")},children:"Retreat"})]})})},me=function(){return Object(G.jsxs)(h.a,{children:[Object(G.jsx)(c.a,{position:"static",children:Object(G.jsxs)(a.a,{children:[Object(G.jsx)(u.a,{variant:"h6",component:"div",sx:{flexGrow:1},children:"Network Simulator"}),Object(G.jsx)(u.a,{component:"div",sx:{flexGrow:1},children:"You can click on Node to view it state."})]})}),Object(G.jsxs)("div",{className:ue.a.main,children:[Object(G.jsxs)("nav",{className:ue.a.navPane,children:[Object(G.jsx)(u.a,{variant:"h6",component:"div",children:"Patterns"}),Object(G.jsx)(d.a,{children:Object(G.jsx)(h.b,{to:"/req-rep",style:{textDecoration:"none"},children:"Request-Reply"})}),Object(G.jsx)(d.a,{children:Object(G.jsx)(h.b,{to:"/pub-sub",style:{textDecoration:"none"},children:"Pub-Sub"})}),Object(G.jsx)(d.a,{children:Object(G.jsx)(h.b,{to:"/survey",style:{textDecoration:"none"},children:"Survey"})}),Object(G.jsx)(d.a,{children:Object(G.jsx)(h.b,{to:"/bgp",style:{textDecoration:"none"},children:"Byzantine Generals"})}),Object(G.jsx)(d.a,{children:Object(G.jsx)(h.b,{to:"/ping-pong",style:{textDecoration:"none"},children:"Ping Pong"})})]}),Object(G.jsxs)("div",{className:ue.a.page,children:[Object(G.jsx)(l.a,{path:"/",exact:!0,component:fe}),Object(G.jsx)(l.a,{path:"/ping-pong",exact:!0,component:ce}),Object(G.jsx)(l.a,{path:"/req-rep",exact:!0,component:fe}),Object(G.jsx)(l.a,{path:"/pub-sub",exact:!0,component:ve}),Object(G.jsx)(l.a,{path:"/survey",exact:!0,component:ye}),Object(G.jsx)(l.a,{path:"/bgp",exact:!0,component:ge})]})]})]})};o.a.render(Object(G.jsx)(r.a.StrictMode,{children:Object(G.jsx)(me,{})}),document.getElementById("root"))}},[[98,1,2]]]);
//# sourceMappingURL=main.e3562ec9.chunk.js.map